conda install pytorch torchvision torchaudio cudatoolkit=11.8 -c pytorch -c nvidia


python run.py \
       --output_dir=lingmess-longformer \
       --overwrite_output_dir \
       --model_name_or_path=allenai/longformer-large-4096 \
       --train_file=prepare_sanskrit_mahabharat/train_file_with_clusters_split.jsonlines \
       --dev_file=prepare_sanskrit_mahabharat/val_file_with_clusters_split.jsonlines \
       --test_file=prepare_sanskrit_mahabharat/test_file_with_clusters_split.jsonlines \
       --max_tokens_in_batch=5000 \
       --do_train \
       --eval_split=dev \
       --logging_steps=4000 \
       --eval_steps=4000 \
       --train_epochs=100 \
       --head_learning_rate=3e-4 \
       --learning_rate=1e-5 \
       --ffnn_size=2048 \
       --experiment_name="lingmess" \
       --device=cuda:0

python run.py \
       --model_name_or_path=lingmess-longformer/model \
       --output_file=prepare_sanskrit_mahabharat/test_file_small_with_clusters_predicted.jsonlines \
       --test_file=prepare_sanskrit_mahabharat/test_file_with_clusters_split.jsonlines \
       --eval_split=test \
       --max_tokens_in_batch=15000 \
       --device=cuda:0

python run.py \
       --model_name_or_path=lingmess-longformer/model \
       --output_file=prepare_sanskrit_mahabharat/test_file_small_predicted.jsonlines \
       --test_file=prepare_sanskrit_mahabharat/test_file_small.jsonlines \
       --eval_split=test \
       --max_tokens_in_batch=15000 \
       --device=cuda:0

python run.py \
       --model_name_or_path=lingmess-longformer/model \
       --output_file=fixed_test_gold_pred/test_file_with_clusters_predicted.jsonlines \
       --test_file=fixed_test_gold_pred/test_file_with_clusters_gold.jsonlines \
       --eval_split=test \
       --max_tokens_in_batch=15000 \
       --device=cuda:0

python run.py \
       --model_name_or_path=lingmess-longformer/model \
       --output_file=fixed_test_gold_pred/test_file_with_clusters_predicted_wo_sandhi.jsonlines \
       --test_file=fixed_test_gold_pred/test_file_with_clusters_gold_wo_sandhi.jsonlines \
       --eval_split=test \
       --max_tokens_in_batch=15000 \
       --device=cuda:0

python run.py \
       --model_name_or_path=lingmess-longformer_new2/model \
       --output_file=fixed_test_gold_pred/test_file_with_clusters_predicted.jsonlines \
       --test_file=fixed_test_gold_pred/test_file_with_clusters_gold.jsonlines \
       --eval_split=test \
       --max_tokens_in_batch=15000 \
       --device=cuda:0


python run.py \
       --model_name_or_path=lingmess-longformer_new2/model \
       --output_file=lingmess-longformer_new2/test_file_with_clusters_predicted.jsonlines \
       --test_file=fixed_test_gold_pred/test_file_with_clusters_gold.jsonlines \
       --eval_split=test \
       --max_tokens_in_batch=15000 \
       --device=cuda:0


python run.py \
       --output_dir=lingmess-longformer_vibhuki \
       --overwrite_output_dir \
       --model_name_or_path=allenai/longformer-large-4096 \
       --train_file=prepare_sanskrit_mahabharat/train_file_with_clusters_split.jsonlines \
       --dev_file=prepare_sanskrit_mahabharat/val_file_with_clusters_split.jsonlines \
       --test_file=prepare_sanskrit_mahabharat/test_file_with_clusters_split_v2.jsonlines \
       --max_tokens_in_batch=5000 \
       --do_train \
       --eval_split=dev \
       --logging_steps=2000 \
       --eval_steps=2000 \
       --train_epochs=100 \
       --head_learning_rate=3e-4 \
       --learning_rate=1e-5 \
       --ffnn_size=4096 \
       --experiment_name="lingmess" \
       --device=cuda:1 > model_run.txt