Namespace(batch_size=8, candidate_dropout=0.0, checkpoint_every_n_steps=500, checkpoint_metric='ed', data_dir='/home/gourav-pg/.cache/refined', device='cuda:1', download_files=True, ed_dropout=0.05, ed_threshold=0.15, el=True, entity_set='wikipedia', epochs=400, et_dropout=0.1, experiment_name='1745400754', gradient_accumulation_steps=1, lr=5e-05, mask_prob=0.7, mask_random_prob=0.05, max_mentions=400, n_gpu=1, num_candidates_eval=30, num_candidates_train=30, num_warmup_steps=10, output_dir='fine_tuned_models', restore_model_path=None, resume=False, transformer_name='google/muril-base-cased', use_precomputed_descriptions=False)
09:32:34 - refined.training.train.training_args - INFO - Using batch size 8 as n_gpu is 1.
resource files-
{'roberta_base_model': '/home/gourav-pg/.cache/refined/roberta-base/pytorch_model.bin', 'roberta_base_model_config': '/home/gourav-pg/.cache/refined/roberta-base/config.json', 'roberta_base_vocab': '/home/gourav-pg/.cache/refined/roberta-base/vocab.json', 'roberta_base_tokenizer_merges': '/home/gourav-pg/.cache/refined/roberta-base/merges.txt', 'wiki_pem': '/home/gourav-pg/.cache/refined/wikipedia_data/pem.lmdb', 'class_to_label': '/home/gourav-pg/.cache/refined/wikipedia_data/class_to_label.json', 'human_qcodes': '/home/gourav-pg/.cache/refined/wikipedia_data/human_qcodes.json', 'class_to_idx': '/home/gourav-pg/.cache/refined/wikipedia_data/class_to_idx.json', 'qcode_to_idx': '/home/gourav-pg/.cache/refined/wikipedia_data/qcode_to_idx.lmdb', 'qcode_idx_to_class_idx': '/home/gourav-pg/.cache/refined/wikipedia_data/qcode_to_class_tns_6269457-138.np', 'subclasses': '/home/gourav-pg/.cache/refined/wikipedia_data/subclasses.lmdb', 'descriptions_tns': '/home/gourav-pg/.cache/refined/wikipedia_data/descriptions_tns.pt', 'nltk_sentence_splitter_english': '/home/gourav-pg/.cache/refined/wikipedia_data/nltk_sentence_splitter_english.pickle'}
{'wikipedia_training_dataset': '/home/gourav-pg/.cache/refined/datasets/wikipedia_links_aligned_spans.json'}
resource files-
{'roberta_base_model': '/home/gourav-pg/.cache/refined/roberta-base/pytorch_model.bin', 'roberta_base_model_config': '/home/gourav-pg/.cache/refined/roberta-base/config.json', 'roberta_base_vocab': '/home/gourav-pg/.cache/refined/roberta-base/vocab.json', 'roberta_base_tokenizer_merges': '/home/gourav-pg/.cache/refined/roberta-base/merges.txt', 'wiki_pem': '/home/gourav-pg/.cache/refined/wikipedia_data/pem.lmdb', 'class_to_label': '/home/gourav-pg/.cache/refined/wikipedia_data/class_to_label.json', 'human_qcodes': '/home/gourav-pg/.cache/refined/wikipedia_data/human_qcodes.json', 'class_to_idx': '/home/gourav-pg/.cache/refined/wikipedia_data/class_to_idx.json', 'qcode_to_idx': '/home/gourav-pg/.cache/refined/wikipedia_data/qcode_to_idx.lmdb', 'qcode_idx_to_class_idx': '/home/gourav-pg/.cache/refined/wikipedia_data/qcode_to_class_tns_6269457-138.np', 'subclasses': '/home/gourav-pg/.cache/refined/wikipedia_data/subclasses.lmdb', 'descriptions_tns': '/home/gourav-pg/.cache/refined/wikipedia_data/descriptions_tns.pt', 'qcode_to_wiki': '/home/gourav-pg/.cache/refined/wikipedia_data/qcode_to_wiki.lmdb', 'nltk_sentence_splitter_english': '/home/gourav-pg/.cache/refined/wikipedia_data/nltk_sentence_splitter_english.pickle'}
09:33:11 - refined.evaluation.evaluation_error - INFO - Running entity linking evaluation
with singleton cluster -
gold_cluster_count =  2900
pred_cluster_count =  2569
gold_mention_count =  6831
pred_mention_count =  6637
total_correct_cluster =  1768  =  0.6096551724137931 %
total_conflated_cluster =  55  =  0.01896551724137931 %
total_divided_cluster =  148  =  0.05103448275862069 %
total_missing_cluster =  929  =  0.3203448275862069 %
total_extra_cluster =  465

mention =  {'missing': 1158, 'extra': 1969}
*****************************


Dataset name: WIKI_DEV

****************
************
f1: 0.6783
accuracy: 0.5859
gold_recall: 0.9999
p: 0.8054
r: 0.5859
num_gold_spans: 6831
************
*******MD*****
MD_f1: 0.6463, (p: 0.6557, r: 0.6371)
*****************

*****************************


09:33:19 - refined.evaluation.evaluation_error - INFO - Running entity disambiguation evaluation
new surface form -  vol_9_chapter_2_subchapter_136_10.txt वैचित्रवीर्यणः  124 Q3512
with singleton cluster -
gold_cluster_count =  2900
pred_cluster_count =  3091
gold_mention_count =  6831
pred_mention_count =  6831
total_correct_cluster =  2578  =  0.8889655172413793 %
total_conflated_cluster =  98  =  0.03379310344827586 %
total_divided_cluster =  224  =  0.07724137931034483 %
total_missing_cluster =  0  =  0.0 %
total_extra_cluster =  0

mention =  {'missing': 0, 'extra': 0}
*****************************


Dataset name: WIKI_DEV

****************
************
f1: 0.9244
accuracy: 0.9243
gold_recall: 0.9999
p: 0.9245
r: 0.9243
num_gold_spans: 6831
************

*****************************


